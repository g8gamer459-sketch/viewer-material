<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no" />
  <title>Jardim para a Minha Namorada üíó</title>
  <style>
    :root {
      --accent: #b4388f; 
      --petal: #ffe3f1; 
      --petal-stroke: #e6a4c7; 
      --center: #ffd86b; 
      --center-stroke: #e6b84a;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }

    html, body {
      height: 100%;
      width: 100%;
      overflow: hidden;
      touch-action: manipulation;
    }

    body {
      background: linear-gradient(135deg, #fff1f8 0%, #f7e7ff 50%, #ffeef6 100%);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
      position: relative;
      user-select: none;
      -webkit-user-select: none;
    }

    #garden {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    .lily {
      position: absolute;
      width: 80px;
      height: 80px;
      transform: translate(-50%, -50%) scale(0);
      opacity: 0;
      pointer-events: none;
      z-index: 1;
    }

    /* ANIMA√á√ÉO SIMPLES E COMPAT√çVEL */
    .lily.pop {
      animation: growAndFloat 1.2s ease-out forwards;
    }

    @keyframes growAndFloat {
      0% {
        transform: translate(-50%, -50%) scale(0);
        opacity: 0;
      }
      50% {
        transform: translate(-50%, -50%) scale(1.1);
        opacity: 1;
      }
      100% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
    }

    /* Anima√ß√£o cont√≠nua ap√≥s aparecer */
    .lily.pop {
      animation: growAndFloat 1.2s ease-out forwards, gentleFloat 3s ease-in-out infinite 1.2s;
    }

    @keyframes gentleFloat {
      0%, 100% {
        transform: translate(-50%, -50%) scale(1) rotate(0deg);
      }
      50% {
        transform: translate(-50%, -52%) scale(1.02) rotate(2deg);
      }
    }

    #clickHint {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      text-align: center;
      font-size: 18px;
      color: #d1469c;
      opacity: 0.3;
      font-weight: 300;
      letter-spacing: 8px;
      pointer-events: none;
      z-index: 2;
      animation: pulseHint 2s ease-in-out infinite alternate;
    }

    @keyframes pulseHint {
      0% { opacity: 0.2; }
      100% { opacity: 0.4; }
    }

    #reset {
      position: fixed;
      right: 15px;
      bottom: 15px;
      background: var(--accent);
      border: none;
      color: white;
      padding: 10px 20px;
      border-radius: 25px;
      font-size: 14px;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 10;
      cursor: pointer;
    }

    .max-note {
      position: fixed;
      left: 50%;
      bottom: 20px;
      transform: translateX(-50%);
      background: #ffffff;
      border-radius: 20px;
      padding: 8px 16px;
      font-size: 14px;
      border: 1px solid #efc8e5;
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: 10;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .max-note.show {
      opacity: 1;
      animation: bounceNote 0.5s ease;
    }

    @keyframes bounceNote {
      0% { transform: translateX(-50%) scale(0.8); }
      70% { transform: translateX(-50%) scale(1.1); }
      100% { transform: translateX(-50%) scale(1); }
    }

    /* Para mobile */
    @media (max-width: 768px) {
      .lily {
        width: 70px;
        height: 70px;
      }
      
      #clickHint {
        font-size: 16px;
        letter-spacing: 6px;
      }
      
      #reset {
        padding: 12px 24px;
        font-size: 16px;
      }
    }
  </style>
</head>
<body>
  <div id="garden"></div>
  <div id="clickHint">TOCA NO ECR√É</div>
  <div class="max-note" id="maxNote">Limite atingido üíó</div>
  <button id="reset">Limpar</button>

  <script>
    // Dete√ß√£o robusta de mobile
    const isMobile = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
    
    const garden = document.getElementById('garden');
    const maxNote = document.getElementById('maxNote');
    const resetBtn = document.getElementById('reset');
    const MAX_FLOWERS = isMobile ? 40 : 70; // Menos flores em mobile
    
    // Prevenir comportamentos indesejados
    document.addEventListener('touchstart', function(e) {
      if (e.touches.length > 1) e.preventDefault();
    }, { passive: false });
    
    document.addEventListener('touchmove', function(e) {
      e.preventDefault();
    }, { passive: false });
    
    // SVG da flor - vers√£o simplificada
    function createFlowerSVG() {
      return `
        <svg viewBox="0 0 100 100" width="100%" height="100%">
          <!-- P√©talas -->
          <g fill="#ffe3f1" stroke="#e6a4c7" stroke-width="1.5">
            <path d="M50 15 C35 30, 30 60, 50 75 C70 60, 65 30, 50 15"/>
            <path d="M50 15 C35 30, 30 60, 50 75 C70 60, 65 30, 50 15" transform="rotate(72 50 50)"/>
            <path d="M50 15 C35 30, 30 60, 50 75 C70 60, 65 30, 50 15" transform="rotate(144 50 50)"/>
            <path d="M50 15 C35 30, 30 60, 50 75 C70 60, 65 30, 50 15" transform="rotate(216 50 50)"/>
            <path d="M50 15 C35 30, 30 60, 50 75 C70 60, 65 30, 50 15" transform="rotate(288 50 50)"/>
          </g>
          <!-- Centro -->
          <circle cx="50" cy="50" r="12" fill="#ffd86b" stroke="#e6b84a" stroke-width="1.5"/>
        </svg>
      `;
    }
    
    // Criar flor numa posi√ß√£o
    function createFlower(x, y) {
      if (garden.children.length >= MAX_FLOWERS) {
        showMaxNote();
        return;
      }
      
      const flower = document.createElement('div');
      flower.className = 'lily';
      flower.style.left = x + 'px';
      flower.style.top = y + 'px';
      
      // Rota√ß√£o aleat√≥ria
      const rotation = Math.random() * 15 - 7.5;
      flower.style.setProperty('--rotation', rotation + 'deg');
      
      flower.innerHTML = createFlowerSVG();
      garden.appendChild(flower);
      
      // For√ßar reflow e depois adicionar anima√ß√£o
      void flower.offsetWidth;
      flower.classList.add('pop');
      
      hideHint();
    }
    
    // Mostrar aviso de limite
    function showMaxNote() {
      maxNote.classList.add('show');
      setTimeout(() => maxNote.classList.remove('show'), 1500);
    }
    
    // Esconder hint
    function hideHint() {
      const hint = document.getElementById('clickHint');
      if (hint) hint.style.display = 'none';
    }
    
    // Processar toques/cliques
    function handleInteraction(e) {
      e.preventDefault();
      
      let x, y;
      
      if (e.type.includes('touch')) {
        x = e.touches[0].clientX;
        y = e.touches[0].clientY;
      } else {
        x = e.clientX;
        y = e.clientY;
      }
      
      createFlower(x, y);
    }
    
    // EVENTOS PRINCIPAIS
    if (isMobile) {
      // Para mobile - apenas touchstart (mais performance)
      garden.addEventListener('touchstart', handleInteraction, { passive: false });
    } else {
      // Para desktop
      garden.addEventListener('click', handleInteraction);
    }
    
    // Bot√£o limpar
    resetBtn.addEventListener('click', function() {
      garden.innerHTML = '';
      document.getElementById('clickHint').style.display = 'block';
    });
    
    // Flor inicial
    window.addEventListener('load', function() {
      setTimeout(() => {
        const x = window.innerWidth / 2;
        const y = window.innerHeight / 2;
        createFlower(x, y);
      }, 500);
    });
    
    // Debug - ver se as anima√ß√µes est√£o a funcionar
    console.log('Mobile:', isMobile);
    console.log('Animations supported:', 
      'animation' in document.documentElement.style || 
      'webkitAnimation' in document.documentElement.style);
  </script>
</body>
</html>
